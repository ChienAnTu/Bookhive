# ./nginx/block-probes.conf
# Block suspicious paths
merge_slashes off;

location ~* /vendor/phpunit/                 { return 444; }
location ~* /phpmyadmin/                     { return 444; }
location ~* /wp-admin/                       { return 444; }
location = /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php { return 444; }

# Block common scanning User-Agents
if ($http_user_agent ~* "(libredtail-http|sqlmap|nikto|acunetix|wfuzz|masscan|zgrab|python-requests)") {
    return 444;
}

# Block obvious probe query strings
location ~* "(?:\?|&)(?:eval|cmd|shell|phpinfo|exec)=" { return 444; }


